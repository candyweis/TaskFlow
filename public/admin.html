<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskFlow - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="css/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="authModal" class="modal show">
        <div class="modal-content">
            <div class="auth-container">
                <div class="auth-header">
                    <i class="fas fa-shield-alt"></i>
                    <h2>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å TaskFlow</h2>
                </div>
                <form id="authForm">
                    <div class="form-group has-icon">
                        <input type="text" id="username" placeholder="–ò–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" required>
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <div class="form-group has-icon">
                        <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <i class="fas fa-lock"></i>
                    </div>
                    <button type="submit" id="authButton" class="btn btn-primary">
                        <span id="authButtonText">–í–æ–π—Ç–∏</span>
                        <div id="authLoader" class="loader" style="display: none;"></div>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
    <div id="adminPanel" class="d-none">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="admin-navbar">
            <div class="nav-brand">
                <i class="fas fa-shield-alt"></i>
                <h1>TaskFlow Admin</h1>
            </div>
            <div class="nav-menu">
                <button class="nav-btn active" data-section="stats">
                    <i class="fas fa-chart-pie"></i>
                    <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </button>
                <button class="nav-btn" data-section="analytics">
                    <i class="fas fa-clock"></i>
                    <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏</span>
                </button>
                <button class="nav-btn" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                </button>
                <button class="nav-btn" data-section="projects">
                    <i class="fas fa-project-diagram"></i>
                    <span>–ü—Ä–æ–µ–∫—Ç—ã</span>
                </button>
                <button class="nav-btn" data-section="overleaf">
                    <i class="fas fa-external-link-alt"></i>
                    <span>Overleaf</span>
                </button>
                <a href="/" class="nav-btn">
                    <i class="fas fa-arrow-left"></i>
                    <span>–ù–∞ —Å–∞–π—Ç</span>
                </a>
            </div>
            <div class="nav-user">
                <span id="currentAdmin"></span>
                <button id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>–í—ã—Ö–æ–¥</span>
                </button>
            </div>
        </nav>

        <!-- –°–µ–∫—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <section id="statsSection" class="content-section">
            <div class="section-header">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h2>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalUsers">0</h3>
                        <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalProjects">0</h3>
                        <p>–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalTasks">0</h3>
                        <p>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="completedTasks">0</h3>
                        <p>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ -->
        <section id="analyticsSection" class="content-section" style="display: none;">
            <div class="section-header">
                <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã</h2>
                <div class="analytics-filters">
                    <select id="periodFilter" class="form-control">
                        <option value="week">–ù–µ–¥–µ–ª—è</option>
                        <option value="month" selected>–ú–µ—Å—è—Ü</option>
                        <option value="quarter">–ö–≤–∞—Ä—Ç–∞–ª</option>
                        <option value="year">–ì–æ–¥</option>
                    </select>
                    
                    <select id="employeeFilter" class="form-control">
                        <option value="">–í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</option>
                    </select>
                    
                    <button id="exportBtn" class="btn btn-primary">
                        <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç CSV
                    </button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalHours">0</h3>
                        <p>–í—Å–µ–≥–æ —á–∞—Å–æ–≤ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="activeEmployees">0</h3>
                        <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="completedWithTime">0</h3>
                        <p>–ó–∞–¥–∞—á —Å —É—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="avgHoursPerTask">0</h3>
                        <p>–ß–∞—Å–æ–≤ –Ω–∞ –∑–∞–¥–∞—á—É</p>
                    </div>
                </div>
            </div>

            <div class="analytics-table">
                <h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º</h3>
                <div class="table-container">
                    <table id="employeeStatsTable">
                        <thead>
                            <tr>
                                <th>üë§ –°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                <th>‚úÖ –ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</th>
                                <th>‚è∞ –í—Å–µ–≥–æ —á–∞—Å–æ–≤</th>
                                <th>üìä –°—Ä–µ–¥–Ω–∏–µ —á–∞—Å—ã –Ω–∞ –∑–∞–¥–∞—á—É</th>
                                <th>üìù –ó–∞–ø–∏—Å–µ–π –≤—Ä–µ–º–µ–Ω–∏</th>
                            </tr>
                        </thead>
                        <tbody id="employeeStatsBody">
                            <tr>
                                <td colspan="5" class="loading-cell">
                                    <div class="spinner"></div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        <section id="usersSection" class="content-section" style="display: none;">
            <div class="section-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                <button id="addUserBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                </button>
            </div>
            <div class="users-table-container">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                            <th>–†–æ–ª—å</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>Telegram</th>
                            <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                            <th>–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr>
                            <td colspan="8" class="loading-cell">
                                <div class="spinner"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
        <section id="projectsSection" class="content-section" style="display: none;">
            <div class="section-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</h2>
                <button id="addProjectBtn" class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
                </button>
            </div>
            <div class="projects-table-container">
                <table class="projects-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                            <th>–°–æ–∑–¥–∞—Ç–µ–ª—å</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="projectsTableBody">
                        <tr>
                            <td colspan="6" class="loading-cell">
                                <div class="spinner"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è Overleaf –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
        <section id="overleafSection" class="content-section" style="display: none;">
            <div class="section-header">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ Overleaf</h2>
                <button id="addOverleafProjectBtn" class="btn btn-success">
                    <i class="fas fa-plus"></i>
                    –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç Overleaf
                </button>
            </div>
            <div class="overleaf-table-container">
                <table class="overleaf-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                            <th>–°—Å—ã–ª–∫–∞</th>
                            <th>–°–æ–∑–¥–∞—Ç–µ–ª—å</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="overleafTableBody">
                        <tr>
                            <td colspan="7" class="loading-cell">
                                <div class="spinner"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <button class="close">&times;</button>
            </div>
            <form id="userForm">
                <div class="form-group">
                    <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *</label>
                    <input type="text" id="userUsername" required>
                </div>
                <div class="form-group" id="passwordGroup">
                    <label>–ü–∞—Ä–æ–ª—å *</label>
                    <input type="password" id="userPassword" required>
                </div>
                <div class="form-group">
                    <label>–†–æ–ª—å</label>
                    <select id="userRole">
                        <option value="worker">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</option>
                        <option value="manager">–ú–µ–Ω–µ–¥–∂–µ—Ä</option>
                        <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Telegram</label>
                    <input type="text" id="userTelegram" placeholder="@username –∏–ª–∏ t.me/username">
                </div>
                <div class="form-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" id="userPhone" placeholder="+7 (999) 123-45-67">
                </div>
                <div class="form-group">
                    <label>–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</label>
                    <input type="text" id="userVk" placeholder="vk.com/username –∏–ª–∏ @username">
                </div>
                <div class="form-group">
                    <label>–°—Ç–∞—Ç—É—Å</label>
                    <select id="userStatus">
                        <option value="1">–ê–∫—Ç–∏–≤–µ–Ω</option>
                        <option value="0">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</label>
                    <div class="permissions-grid">
                        <label class="permission-item">
                            <input type="checkbox" id="canManageUsers">
                            <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canManageProjects">
                            <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canManageTasks">
                            <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canDevelop">
                            <span>–¢–µ—Ö–∞—Ä—å</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canReview">
                            <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞</span>
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="canDeploy">
                            <span>–ó–∞–≥—Ä—É–∂–∞—Ç—å</span>
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('userModal')">
                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–µ–∫—Ç–∞ -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="projectModalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="close">&times;</button>
            </div>
            <form id="projectForm">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="projectDescription" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('projectModal')">
                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ Overleaf –ø—Ä–æ–µ–∫—Ç–∞ -->
    <div id="overleafProjectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="overleafProjectModalTitle">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç Overleaf</h3>
                <button class="close">&times;</button>
            </div>
            <form id="overleafProjectForm">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                    <input type="text" id="overleafProjectName" required>
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="overleafProjectDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç</label>
                    <input type="url" id="overleafProjectLink" placeholder="https://overleaf.com/project/...">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('overleafProjectModal')">
                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>
